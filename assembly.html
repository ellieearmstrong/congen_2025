  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ConGen2025 Assembly Workshop – Assembly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --accent: #2563eb;
      --nav-bg: rgba(17, 24, 39, 0.95);
      --card-bg: rgba(249, 250, 251, 0.96);
      --text-main: #111827;
      --text-muted: #4b5563;
      --border-subtle: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text-main);
      background:
        linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
        url("https://cdn.pixabay.com/photo/2019/11/26/18/05/montana-4652867_1280.jpg") no-repeat center center fixed;
      background-size: cover;
      display: flex;
      flex-direction: column;
    }

    /* NAVIGATION */
    .navbar-shell { padding: 0.75rem 1rem 0; }
    .navbar {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      background: var(--nav-bg);
      display: flex;
      justify-content: center;
      gap: 0.75rem;
      border: 1px solid rgba(55,65,81,0.9);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
      color: #e5e7eb; flex-wrap: wrap;
      position: relative;
      z-index: 10;
    }
    .nav-link, .nav-dropdown > a {
      color: #e5e7eb; text-decoration: none;
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      transition: background 0.15s;
      white-space: nowrap;
    }
    .nav-link:hover, .nav-dropdown > a:hover { background: rgba(31,41,55,0.9); }
    .nav-link.active, .nav-dropdown > a.active {
      background: #f9fafb; color: #111827; font-weight: 600;
    }

    /* DROPDOWN */
    .nav-dropdown { position: relative; }
    .dropdown-caret { font-size: 0.75rem; }
    .dropdown-menu {
      position: absolute; top: 100%; left: 0; margin-top: 0;
      background: #f9fafb; border-radius: 14px; border: 1px solid #e5e7eb;
      min-width: 170px; padding: 0.25rem 0;
      display: none; box-shadow: 0 18px 50px rgba(0,0,0,0.4); z-index: 20;
    }
    .dropdown-menu a {
      display: block; padding: 0.45rem 0.9rem;
      font-size: 0.9rem; color: #374151; text-decoration: none;
    }
    .dropdown-menu a:hover { background: #e5e7eb; }
    .nav-dropdown:hover .dropdown-menu { display: block; }

    /* PAGE SHELL */
    .page {
      flex: 1; display: flex; justify-content: center;
      padding: 1rem; padding-bottom: 2.5rem;
    }
    .page-inner { width: 100%; max-width: 1000px; }
    .card {
      margin-top: 1.25rem; background: var(--card-bg);
      border-radius: 18px; padding: 1.75rem 2rem 2rem;
      border: 1px solid #e5e7eb;
      box-shadow: 0 22px 50px rgba(0,0,0,0.45);
    }

    .page-header h1 {
      margin: 0 0 0.5rem; font-size: clamp(1.8rem, 3vw, 2.2rem);
    }
    .page-header p { margin: 0.25rem 0; color: var(--text-muted); }

    /* CONTENTS BOX */
    .page-contents {
      margin: 1.5rem 0 1.25rem;
      background: #f3f4f6; border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 0.85rem 1rem; font-size: 0.9rem;
    }
    .page-contents-title {
      font-size: 0.85rem; letter-spacing: 0.12em;
      text-transform: uppercase; color: #6b7280;
    }
    .page-contents ul { list-style: none; padding: 0; margin: 0; }

    /* SECTION HEADINGS */
    .section { margin-top: 1.5rem; }
    .section h2 { margin-top: 0; font-size: 1.2rem; }
    .section p, ul, ol { color: var(--text-muted); font-size: 0.95rem; }

    /* CODE BLOCKS */
    .code-block-green {
      background: #dcfce7; border: 1px solid #86efac;
      border-radius: 12px; padding: 1rem 1.5rem;
      display: inline-block; font-family: monospace;
      white-space: pre-wrap; color: #065f46;
      box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    }
    .code-block { background: #111827; color: #f9fafb;
      border-radius: 10px; padding: 0.6rem 0.9rem;
      margin: 0.7rem 0; font-family: monospace; }

    /* TABLES */
    table {
      width: 100%; border-collapse: collapse;
      margin: 0.75rem 0 1rem; font-size: 0.9rem;
    }
    th, td {
      border: 1px solid #e5e7eb;
      padding: 0.4rem 0.55rem; text-align: left;
    }
    th { background: #f3f4f6; font-weight: 600; }

    /* FIGURES */
    figure {
      margin: 1rem 0; border-radius: 12px;
      border: 1px solid #e5e7eb; overflow: hidden; background: white;
    }
    figure img { width: 100%; display: block; }
    figcaption { padding: 0.5rem 0.8rem; background: #f9fafb; font-size: 0.85rem; }
  </style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar-shell">
  <nav class="navbar">
    <a href="intro.html" class="nav-link">Intro</a>

    <div class="nav-dropdown">
      <a href="workshop.html" class="active">
        Workshop <span class="dropdown-caret">▾</span>
      </a>
      <div class="dropdown-menu">
        <a href="workshop.html#start">Start</a>
        <a href="reads.html">Reads</a>
        <a href="assembly.html">Assembly</a>
      </div>
    </div>

    <a href="terminology.html" class="nav-link">Terminology</a>
    <a href="programs.html" class="nav-link">Programs</a>
    <a href="links.html" class="nav-link">Links</a>
  </nav>
</div>

<!-- MAIN CONTENT -->
<main class="page">
  <div class="page-inner">
    <section class="card">

      <!-- HEADER -->
      <header class="page-header">
        <h1>Genome assembly</h1>
        <p>This module walks through genome assembly using short and long reads, and introduces methods for evaluating assembly quality and completeness.</p>
      </header>

      <!-- CONTENTS -->
      <section class="page-contents" id="index">
        <div class="page-contents-title">Page contents</div>
        <ul>
          <li><a href="#intro">Introduction</a></li>
          <li><a href="#spades">Short-read assembly with SPAdes</a></li>
          <li><a href="#assessing">Assessing assembly quality</a></li>
          <li><a href="#flye">Long-read assembly with Flye</a></li>
          <li><a href="#hifiasm">Long-read assembly with Hifiasm</a></li>
          <li><a href="#assembly-quality">Assembly quality</a></li>
          <li><a href="#compleasm">Assembly completeness with compleasm</a></li>
          <li><a href="#hic">Interpreting Hi-C data</a></li>
          <li><a href="#further">Further analyses</a></li>
        </ul>
      </section>

      <!-- INTRO -->
      <section class="section" id="intro">
        <h2>Introduction</h2>

        <p>
          A genome assembly attempts to reconstruct an organism’s chromosomes from many short or long sequencing reads.
          Short-read assemblers typically rely on <strong>de Bruijn graphs</strong>, while long-read assemblers use
          <strong>overlap-based</strong> approaches. Both models aim to resolve repeats, heterozygosity, and coverage variation.
        </p>

        <figure>
          <img src="img/assembly-graph.png" alt="Cartoon of an assembly graph." />
          <figcaption>Figure 4.1 – Example assembly graph structure.</figcaption>
        </figure>

        <p>
          In this module, we begin with a short-read assembly using SPAdes, then move to long-read approaches with Flye and Hifiasm,
          before finishing with completeness assessment and Hi-C–based scaffolding concepts.
        </p>
      </section>

      <!-- SPADES -->
      <section class="section" id="spades">
        <h2>Short-read assembly with SPAdes</h2>

        <p>We’ll assemble example Illumina reads using SPAdes:</p>

<div class="code-block-green">
spades.py \
  -1 dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz \
  -2 dpse-chr2-reads/illumina/pse-chr2_2.fastq.gz \
  -o spades-output \
  -t 4 \
  -m 8
</div>

        <table>
          <thead><tr><th>Parameter</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>-1</code>, <code>-2</code></td><td>Paired-end FASTQ files.</td></tr>
            <tr><td><code>-o</code></td><td>Output directory.</td></tr>
            <tr><td><code>-t</code></td><td>Threads.</td></tr>
            <tr><td><code>-m</code></td><td>Max memory (GB).</td></tr>
          </tbody>
        </table>

        <p>SPAdes writes contigs, scaffolds, graphs, and logs into <code>spades-output/</code>.</p>

        <figure>
          <img src="img/spades-graph.png" alt="Example SPAdes assembly graph." />
          <figcaption>Figure 4.2 – Example SPAdes graph (placeholder).</figcaption>
        </figure>
      </section>

      <!-- ASSESSING ASSEMBLY QUALITY -->
      <section class="section" id="assessing">
        <h2>Assessing assembly quality</h2>

        <p>
          After assembling reads into contigs or scaffolds, we want to assess basic quality metrics:
        </p>

        <ul>
          <li><strong>Contiguity</strong> — N50, total size, number of contigs.</li>
          <li><strong>Completeness</strong> — are expected genes present? (See compleasm below.)</li>
          <li><strong>Accuracy</strong> — do reads map cleanly back to the assembly?</li>
        </ul>

        <h3>Interpreting SPAdes output</h3>

        <p>
          SPAdes generates both contigs and scaffolds:
        </p>

        <ul>
          <li><code>contigs.fasta</code> — strict contigs with no gaps.</li>
          <li><code>scaffolds.fasta</code> — contigs joined with <code>N</code>-gaps where read-pair evidence supports links.</li>
        </ul>

        <p>
          The number and size distribution of these contigs is a first clue about assembly quality. A fragmented short-read assembly is expected for large
          vertebrate genomes; long-read data dramatically improves this (see Flye and Hifiasm sections).
        </p>

        <h3>Mapping reads back to the assembly</h3>

        <p>
          One of the most common ways to check assembly accuracy is to map the original reads back to the assembly.
          Here we use <code>bwa</code> (for short reads), followed by <code>samtools</code>:
        </p>

<div class="code-block-green">
bwa index spades-output/contigs.fasta

bwa mem -t 4 spades-output/contigs.fasta \
  dpse-chr2-reads/illumina/pse-chr2_1.fastq.gz \
  dpse-chr2-reads/illumina/pse-chr2_2.fastq.gz \
  | samtools sort -o mapped_sorted.bam
</div>

        <p>Generate alignment statistics:</p>

<div class="code-block-green">
samtools flagstat mapped_sorted.bam
samtools stats mapped_sorted.bam > mapping_stats.txt
</div>

        <p>
          High mapping rates and low mismatch frequencies suggest the assembly is largely correct.
          Very low mapping rates can indicate contamination, misassemblies, or major missing regions.
        </p>
      </section>

      <!-- FLYE -->
      <section class="section" id="flye">
        <h2>Long-read assembly with Flye</h2>

        <p>
          Flye is designed for noisy long reads (Nanopore, PacBio CLR) and constructs repeat graphs directly from overlaps.
        </p>

<div class="code-block-green">
flye \
  --nano-raw hornbill_nanopore_reads.fastq.gz \
  --genome-size 1.4g \
  --out-dir flye-output \
  --threads 8
</div>

        <p>
          Flye produces <code>assembly.fasta</code>, logs, and graph files inside <code>flye-output/</code>.
        </p>
      </section>

      <!-- HIFIASM -->
      <section class="section" id="hifiasm">
        <h2>Long-read assembly with Hifiasm</h2>

        <p>
          Hifiasm is optimized for highly accurate PacBio HiFi reads and produces phased assemblies when possible.
        </p>

<div class="code-block-green">
hifiasm \
  -o hornbill_hifiasm \
  -t 16 \
  hornbill_hifi_reads.fastq.gz
</div>

        <ul>
          <li><code>.p_ctg.gfa</code> — primary contigs</li>
          <li><code>.a_ctg.gfa</code> — alternate contigs</li>
        </ul>

      </section>

      <!-- ASSEMBLY QUALITY SUMMARY -->
      <section class="section" id="assembly-quality">
        <h2>Assembly quality</h2>

        <p>
          Assembly quality has three key components:
        </p>

        <ul>
          <li><strong>Contiguity</strong> (N50, L50, total size)</li>
          <li><strong>Accuracy</strong> (read mapping back to the assembly)</li>
          <li><strong>Completeness</strong> (see compleasm below)</li>
        </ul>

        <p>
          Long-read assemblies typically show huge gains in contiguity compared to short-read assemblies.
        </p>
      </section>

      <!-- COMPLEASM -->
      <section class="section" id="compleasm">
        <h2>Assembly completeness with compleasm</h2>

        <p>
          Compleasm evaluates completeness using BUSCO lineage datasets.
          For birds, use <code>aves_odb10</code> or <code>aves_odb12</code>.
        </p>

<div class="code-block-green">
compleasm run \
  -a hornbill_assembly.fasta \
  -o compleasm-output \
  -l aves_odb10 \
  -t 8
</div>

        <figure>
          <img src="img/compleasm-summary.png" alt="Completeness summary plot." />
          <figcaption>Example completeness summary (placeholder).</figcaption>
        </figure>

      </section>

      <!-- HI-C -->
      <section class="section" id="hic">
        <h2>Interpreting Hi-C data</h2>

        <p>
          Hi-C contact maps reveal long-range interactions along chromosomes and are used to scaffold contigs into chromosome-scale assemblies.
        </p>

        <figure>
          <img src="img/hic-contact-map.png" alt="Hi-C contact map." />
          <figcaption>Example Hi-C contact map (placeholder).</figcaption>
        </figure>

        <p>
          A strong diagonal indicates well-assembled chromosomes. Off-diagonal blocks may indicate misjoins or rearrangements.
        </p>
      </section>

      <!-- FURTHER ANALYSES -->
      <section class="section" id="further">
        <h2>Further analyses</h2>

        <ul>
          <li>Genome annotation</li>
          <li>Variant calling</li>
          <li>Comparative genomics & synteny</li>
          <li>Demographic inference</li>
          <li>Conservation applications (ROH, mutational load, SVs)</li>
        </ul>

        <p>
          With a complete, accurate assembly, all downstream analyses become more powerful and interpretable.
        </p>
      </section>

    </section>
  </div>
</main>

</body>
</html>
