---
title: Assembly – ConGen 2025 Assembly Workshop
---

<main class="page">
  <div class="page-inner">

    <section class="card">

      <header class="page-header">
        <h1>Genome Assembly</h1>
        <p>This module walks through short- and long-read assembly approaches and introduces methods for evaluating assembly quality and completeness.</p>
      </header>

      <!-- ========================
           PAGE CONTENTS
      ========================= -->
      <section class="page-contents" id="index">
        <div class="page-contents-title">Page contents</div>
        <ul>
          <li><a href="#intro">Introduction</a></li>
          <li><a href="#spades">Short-read assembly with SPAdes</a></li>
          <li><a href="#flye">Long-read assembly with Flye</a></li>
          <li><a href="#hifiasm">Long-read assembly with Hifiasm</a></li>
          <li><a href="#assembly-quality">Assembly quality with N50</a></li>
          <li><a href="#compleasm">Assembly completeness with compleasm</a></li>
          <li><a href="#hic">Interpreting Hi-C data</a></li>
          <li><a href="#further">Further analyses</a></li>
        </ul>
      </section>

      <!-- ========================
           INTRODUCTION
      ========================= -->
      <section class="section" id="intro">
        <h2>Introduction</h2>

        <p>
          A genome assembly attempts to reconstruct an organism’s chromosomes using short or long sequencing reads.
          Short-read assemblers typically use <strong>de Bruijn graphs</strong>, while long-read assemblers rely on
          <strong>overlap-based</strong> methods. Both approaches must contend with repeats, heterozygosity, and uneven coverage.
        </p>

        <figure>
          <img src="Fig3.1.png" alt="Cartoon of a genome assembly graph." />
          <figcaption>Figure 3.1 – Cartoon of an assembly process.</figcaption>
        </figure>

        <p>
          In this module, we begin with a short-read assembly using SPAdes, then explore long-read assembly with Flye and Hifiasm,
          followed by assessing quality and completeness.
        </p>
      </section>

      <!-- ========================
           SPADES
      ========================= -->
      <section class="section" id="spades">
        <h2>Short-read assembly with SPAdes</h2>

        <p>We will assemble example Illumina reads using SPAdes:</p>

        <div class="code-block-green">
spades.py \
  -1 T_deckeni_reads/illumina/SRR31758803-chr2_1.fastq.gz \
  -2 T_deckeni_reads/illumina/SRR31758803-chr2_2.fastq.gz \
  -o assemblies/spades-illumina-chr2-k77/ \
  -k 77 \
  -t 4 \
  -m 8 \
  --isolate
        </div>

        <table>
          <thead><tr><th>Parameter</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>-1</code>, <code>-2</code></td><td>Paired-end FASTQ files.</td></tr>
            <tr><td><code>-o</code></td><td>Output directory.</td></tr>
            <tr><td><code>-k</code></td><td>k-mer size.</td></tr>
            <tr><td><code>-t</code></td><td>Threads.</td></tr>
            <tr><td><code>-m</code></td><td>Max memory (GB).</td></tr>
            <tr><td><code>--isolate</code></td><td>Recommended for cleaner assemblies in high-coverage datasets.</td></tr>
          </tbody>
        </table>

        <figure>
          <img src="Fig3.2.png" alt="Example SPAdes assembly graph." />
          <figcaption>Figure 3.2 – Illustration of repeat compaction in a de Bruijn graph.</figcaption>
        </figure>
      </section>

      <!-- ========================
           FLYE
      ========================= -->
      <section class="section" id="flye">
        <h2>Long-read assembly with Flye</h2>

        <p>
          <a href="https://github.com/mikolmogorov/Flye" target="_blank">Flye</a> is designed for noisy long reads such as Nanopore or PacBio CLR.
          It constructs repeat graphs directly and is robust to residual error.
          This command is shown for reference only:
        </p>

        <div class="code-block-red">
flye \
  --pacbio-hifi T_deckeni_reads/pacbio/pacbio_Tdeckeni_chr2_subsample.fastq.gz \
  --genome-size 0.08 \
  --out-dir assemblies/flye-pacbio-chr2 \
  --threads 4
        </div>

      </section>

      <!-- ========================
           HIFIASM
      ========================= -->
      <section class="section" id="hifiasm">
        <h2>Long-read assembly with Hifiasm</h2>

        <p>Hifiasm is optimized for PacBio HiFi reads and can generate phased assemblies.</p>

        <div class="code-block-red">
hifiasm \
  -o assemblies/hifiasm-pacbio-chr2 \
  -t 16 \
  T_deckeni_reads/pacbio/pacbio_Tdeckeni_chr2_subsample.fastq.gz
        </div>
      </section>

      <!-- ========================
           ASSEMBLY QUALITY (N50)
      ========================= -->
      <section class="section" id="assembly-quality">
        <h2>Assembly quality with N50</h2>

        <p>
          Genome assemblies vary widely in contiguity depending on repeats, heterozygosity, and sequencing strategy.
          Several metrics help summarize assembly quality:
        </p>

        <table>
          <thead><tr><th>Statistic</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td>Total assembly size</td><td>Total number of bases (sum of all contigs/scaffolds).</td></tr>
            <tr><td>Number of scaffolds</td><td>Fewer scaffolds typically indicate higher contiguity.</td></tr>
            <tr><td>N50</td><td>Length at which 50% of assembly is contained in scaffolds of this size or larger.</td></tr>
            <tr><td>L90</td><td>Number of scaffolds making up 90% of assembly.</td></tr>
            <tr><td>NG50</td><td>N50 relative to expected genome size.</td></tr>
            <tr><td>Number of Ns</td><td>Gaps or unresolved regions.</td></tr>
          </tbody>
        </table>

        <figure>
          <img src="Fig3.3.png" alt="N50 explanation figure." />
          <figcaption>Figure 3.3 – Visual explanation of N50.</figcaption>
        </figure>

        <p>
          We will use the <strong>Assemblathon</strong> script to compute these metrics.
          Example:
        </p>

        <div class="code-block-green">
perl /usr/bin/assemblathon_stats.pl \
  expected-outputs/assemblies/Tdeckeni_hap2_yahs.out_scaffolds_final.fa \
  > quality-control/Tdeckeni_hap2_yahs.out_scaffolds_final-assemblathon.txt
        </div>

        <p>This produces a summary table of statistics in the output file.</p>

        <div class="code-block-blue">
[N50 statistics table output truncated for brevity — your real output will appear here]
        </div>

      </section>

      <!-- ========================
           COMPLEASM
      ========================= -->
      <section class="section" id="compleasm">
        <h2>Assembly completeness with compleasm</h2>

        <p>
          Compleasm evaluates the completeness of an assembly using BUSCO-like lineage datasets.
          For birds we use the <strong>aves</strong> lineage.
        </p>

        <div class="code-block-red">
compleasm run \
  -a expected-outputs/assemblies/Tdeckeni_hap2_yahs.out_scaffolds_final.fa \
  -L mb_downloads \
  -l aves \
  -o quality-control/Tdeckeni_hap2_yahs.out_scaffolds_final_aves \
  -t 4
        </div>

        <figure>
          <img src="Fig3.4.png" alt="Compleasm comparison output." />
          <figcaption>Figure 3.4 – Compleasm results for two <em>T. deckeni</em> assemblies.</figcaption>
        </figure>
      </section>

      <!-- ========================
           HI-C SECTION
      ========================= -->
      <section class="section" id="hic">
        <h2>Interpreting Hi-C data</h2>

        <p>
          Hi-C provides long-range linkage information that enables chromosome-scale scaffolding.
          Strong diagonal patterns indicate correct ordering, while disruptions can reveal inversions or misjoins.
        </p>

        <figure>
          <img src="cis_trans_hic.jpg" alt="Hi-C matrix." />
          <figcaption>Figure — Example Hi-C contact map.</figcaption>
        </figure>

        <h3>Examples</h3>
        <p><strong>Inversions</strong> produce bow-tie or mirrored X-patterns in the Hi-C map.</p>

        <figure>
          <img src="inversion_mosquito_example_Lukyanchikova2025.jpg" alt="Inversion Hi-C example." />
          <figcaption>Hi-C signature of an inversion.</figcaption>
        </figure>

        <p><strong>Misjoins</strong> appear as abrupt breaks in the diagonal.</p>

        <figure>
          <img src="Fig3.7.png" alt="Misjoin example." />
          <figcaption>Example misjoin in Hi-C contact data.</figcaption>
        </figure>

        <h3>Tools</h3>

        <table>
          <thead><tr><th>Tool</th><th>Purpose</th><th>Link</th></tr></thead>
          <tbody>
            <tr><td>YaHS</td><td>Modern Hi-C scaffolding</td><td><a href="https://github.com/c-zhou/yahs" target="_blank">GitHub</a></td></tr>
            <tr><td>Juicebox</td><td>Visualization & manual curation</td><td><a href="https://github.com/aidenlab/Juicebox" target="_blank">GitHub</a></td></tr>
            <tr><td>3D-DNA</td><td>Automated Hi-C scaffolding</td><td><a href="https://github.com/aidenlab/3d-dna" target="_blank">GitHub</a></td></tr>
            <tr><td>hicExplorer</td><td>Hi-C plotting tools</td><td><a href="https://hicexplorer.readthedocs.io" target="_blank">Docs</a></td></tr>
          </tbody>
        </table>

        <p>
          Manual curation remains essential in nearly all vertebrate genome projects.
        </p>
      </section>

      <!-- ========================
           FURTHER ANALYSES
      ========================= -->
      <section class="section" id="further">
        <h2>Further analyses</h2>

        <ul>
          <li>Genome annotation</li>
          <li>Variant calling</li>
          <li>Comparative genomics & synteny</li>
          <li>Demographic inference</li>
          <li>Conservation-focused analyses (ROH, mutational load, SVs)</li>
        </ul>

        <p>A high-quality assembly unlocks powerful downstream analyses across evolution, ecology, and conservation genomics.</p>
      </section>

    </section>

  </div>
</main>
