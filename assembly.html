  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ConGen2025 Assembly Workshop – Assembly</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --accent: #2563eb;
      --nav-bg: rgba(17, 24, 39, 0.95);
      --card-bg: rgba(249, 250, 251, 0.96);
      --text-main: #111827;
      --text-muted: #4b5563;
      --border-subtle: #e5e7eb;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: var(--text-main);
      background:
        linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
        url("https://cdn.pixabay.com/photo/2019/11/26/18/05/montana-4652867_1280.jpg") no-repeat center center fixed;
      background-size: cover;
      display: flex;
      flex-direction: column;
    }

    /* NAVIGATION */
    .navbar-shell { padding: 0.75rem 1rem 0; }
    .navbar {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      background: var(--nav-bg);
      display: flex;
      justify-content: center;
      gap: 0.75rem;
      border: 1px solid rgba(55,65,81,0.9);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
      color: #e5e7eb; flex-wrap: wrap;
      position: relative;
      z-index: 10;
    }
    .nav-link, .nav-dropdown > a {
      color: #e5e7eb; text-decoration: none;
      padding: 0.35rem 0.9rem;
      border-radius: 999px;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      transition: background 0.15s;
      white-space: nowrap;
    }
    .nav-link:hover, .nav-dropdown > a:hover { background: rgba(31,41,55,0.9); }
    .nav-link.active, .nav-dropdown > a.active {
      background: #f9fafb; color: #111827; font-weight: 600;
    }

    /* DROPDOWN */
    .nav-dropdown { position: relative; }
    .dropdown-caret { font-size: 0.75rem; }
    .dropdown-menu {
      position: absolute; top: 100%; left: 0; margin-top: 0;
      background: #f9fafb; border-radius: 14px; border: 1px solid #e5e7eb;
      min-width: 170px; padding: 0.25rem 0;
      display: none; box-shadow: 0 18px 50px rgba(0,0,0,0.4); z-index: 20;
    }
    .dropdown-menu a {
      display: block; padding: 0.45rem 0.9rem;
      font-size: 0.9rem; color: #374151; text-decoration: none;
    }
    .dropdown-menu a:hover { background: #e5e7eb; }
    .nav-dropdown:hover .dropdown-menu { display: block; }

    /* PAGE SHELL */
    .page {
      flex: 1; display: flex; justify-content: center;
      padding: 1rem; padding-bottom: 2.5rem;
    }
    .page-inner { width: 100%; max-width: 1000px; }
    .card {
      margin-top: 1.25rem; background: var(--card-bg);
      border-radius: 18px; padding: 1.75rem 2rem 2rem;
      border: 1px solid #e5e7eb;
      box-shadow: 0 22px 50px rgba(0,0,0,0.45);
    }

    .page-header h1 {
      margin: 0 0 0.5rem; font-size: clamp(1.8rem, 3vw, 2.2rem);
    }
    .page-header p { margin: 0.25rem 0; color: var(--text-muted); }

    /* CONTENTS BOX */
    .page-contents {
      margin: 1.5rem 0 1.25rem;
      background: #f3f4f6; border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 0.85rem 1rem; font-size: 0.9rem;
    }
    .page-contents-title {
      font-size: 0.85rem; letter-spacing: 0.12em;
      text-transform: uppercase; color: #6b7280;
    }
    .page-contents ul { list-style: none; padding: 0; margin: 0; }

    /* SECTION HEADINGS */
    .section { margin-top: 1.5rem; }
    .section h2 { margin-top: 0; font-size: 1.2rem; }
    .section p, ul, ol { color: var(--text-muted); font-size: 0.95rem; }

    /* CODE BLOCKS */
    .code-block-green {
      background: #dcfce7; border: 1px solid #86efac;
      border-radius: 12px; padding: 1rem 1.5rem;
      display: inline-block; font-family: monospace;
      white-space: pre-wrap; color: #065f46;
      box-shadow: 0 3px 8px rgba(0,0,0,0.08);
    }
    .code-block-red {
      background: #fee2e2;
      border: 1px solid #fca5a5;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin: 1.25rem auto;
      display: block;
      width: fit-content;
      max-width: 100%;
      font-family: ui-monospace, Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size: 1rem;
      color: #991b1b;
      text-align: center;
      white-space: pre-wrap;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
    }
    .code-block { background: #111827; color: #f9fafb;
      border-radius: 10px; padding: 0.6rem 0.9rem;
      margin: 0.7rem 0; font-family: monospace; }

    /* TABLES */
    table {
      width: 100%; border-collapse: collapse;
      margin: 0.75rem 0 1rem; font-size: 0.9rem;
    }
    th, td {
      border: 1px solid #e5e7eb;
      padding: 0.4rem 0.55rem; text-align: left;
    }
    th { background: #f3f4f6; font-weight: 600; }

    /* FIGURES */
    figure {
      margin: 1rem 0; border-radius: 12px;
      border: 1px solid #e5e7eb; overflow: hidden; background: white;
    }
    figure img { width: 100%; display: block; }
    figcaption { padding: 0.5rem 0.8rem; background: #f9fafb; font-size: 0.85rem; }
  </style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar-shell">
  <nav class="navbar">
    <a href="intro.html" class="nav-link">Intro</a>

    <div class="nav-dropdown">
      <a href="workshop.html" class="active">
        Workshop <span class="dropdown-caret">▾</span>
      </a>
      <div class="dropdown-menu">
        <a href="workshop.html#start">Start</a>
        <a href="reads.html">Reads</a>
        <a href="assembly.html">Assembly</a>
      </div>
    </div>

    <a href="terminology.html" class="nav-link">Terminology</a>
    <a href="programs.html" class="nav-link">Programs</a>
    <a href="links.html" class="nav-link">Links</a>
  </nav>
</div>

<!-- MAIN CONTENT -->
<main class="page">
  <div class="page-inner">
    <section class="card">

      <!-- HEADER -->
      <header class="page-header">
        <h1>Genome assembly</h1>
        <p>This module walks through genome assembly using short and long reads, and introduces methods for evaluating assembly quality and completeness.</p>
      </header>

      <!-- CONTENTS -->
      <section class="page-contents" id="index">
        <div class="page-contents-title">Page contents</div>
        <ul>
          <li><a href="#intro">Introduction</a></li>
          <li><a href="#spades">Short-read assembly with SPAdes</a></li>
          <li><a href="#flye">Long-read assembly with Flye</a></li>
          <li><a href="#hifiasm">Long-read assembly with Hifiasm</a></li>
          <li><a href="#assembly-quality">Assembly quality</a></li>
          <li><a href="#compleasm">Assembly completeness with compleasm</a></li>
          <li><a href="#hic">Interpreting Hi-C data</a></li>
          <li><a href="#further">Further analyses</a></li>
        </ul>
      </section>

      <!-- INTRO -->
      <section class="section" id="intro">
        <h2>Introduction</h2>

        <p>
          A genome assembly attempts to reconstruct an organism’s chromosomes from many short or long sequencing reads.
          Short-read assemblers typically rely on <strong>de Bruijn graphs</strong>, while long-read assemblers use
          <strong>overlap-based</strong> approaches. Both models aim to resolve repeats, heterozygosity, and coverage variation.
        </p>

        <figure>
          <img src="Fig3.1.png" alt="Cartoon of an assembly graph." />
          <figcaption>Figure 3.1 – Cartoon of assembly process.</figcaption>
        </figure>

        <p>
          In this module, we begin with a short-read assembly using SPAdes, then move to long-read approaches with Flye and Hifiasm,
          before finishing with completeness assessment.
        </p>
      </section>

      <!-- SPADES -->
      <section class="section" id="spades">
        <h2>Short-read assembly with SPAdes</h2>

        <p>We’ll assemble example Illumina reads using SPAdes:</p>

<div class="code-block-green">
spades.py \
  -1 T_deckeni_reads/illumina/SRR31758803-chr2_1.fastq.gz \
  -2 T_deckeni_reads/illumina/SRR31758803-chr2_2.fastq.gz \
  -o assemblies/spades-illumina-chr2-k77/ \
  -k 77 \
  -t 4 \
  -m 8 \ 
  --isolate
</div>

        <table>
          <thead><tr><th>Parameter</th><th>Description</th></tr></thead>
          <tbody>
            <tr><td><code>-1</code>, <code>-2</code></td><td>Paired-end FASTQ files.</td></tr>
            <tr><td><code>-o</code></td><td>Output directory.</td></tr>
            <tr><td><code>-k</code></td><td>k-mer size.</td></tr>
            <tr><td><code>-t</code></td><td>Threads.</td></tr>
            <tr><td><code>-m</code></td><td>Max memory (GB).</td></tr>
            <tr><td><code>--isolate</code></td><td>Improves assembly quality and runtime in high-cov data.</td></tr>
          </tbody>
        </table>

        <p>SPAdes writes contigs, scaffolds, graphs, and logs into <code>assemblies/spades-illumina-chr2-k77/</code>.</p>

        <figure>
          <img src="Fig3.2.png" alt="Example SPAdes assembly graph." />
          <figcaption>Figure 3.2 – Figure 2 from Pevzner 2001 showing how repeats are compacted in a de Bruijn graph.</figcaption>
        </figure>
      </section>

      <!-- FLYE -->
      <section class="section" id="flye">
        <h2>Long-read assembly with Flye</h2>

        <p>
          <a href="https://github.com/mikolmogorov/Flye" target="_blank">Flye</a> is designed for noisy long reads (Nanopore, PacBio CLR) and constructs repeat graphs directly using a modified de bruijn approach.
          We will NOT run this command because this step is very memory intensive and takes some time, but here is an example command for you to review.
        </p>

<div class="code-block-red">
flye \
  --pacbio-hifi T_deckeni_reads/pacbio/pacbio_Tdeckeni_chr2_subsample.fastq.gz \
  --genome-size 0.08 \
  --out-dir assemblies/flye-pacbio-chr2 \
  --threads 4
</div>

        <p>
          Flye produces <code>assembly.fasta</code>, logs, and graph files inside <code>flye-pacbio-chr2/</code>.
        </p>
      </section>

      <!-- HIFIASM -->
      <section class="section" id="hifiasm">
        <h2>Long-read assembly with Hifiasm</h2>

        <p>
          Hifiasm is optimized for highly accurate PacBio HiFi reads and produces phased assemblies when possible.
        </p>

<div class="code-block-red">
hifiasm \
  -o assemblies/hifiasm-pacbio-chr2  \
  -t 16 \
  T_deckeni_reads/pacbio/pacbio_Tdeckeni_chr2_subsample.fastq.gz 
</div>

        <ul>
          <li><code>.p_ctg.gfa</code> — primary contigs</li>
          <li><code>.a_ctg.gfa</code> — alternate contigs</li>
        </ul>

      </section>

      <!-- ASSEMBLY QUALITY SUMMARY -->
<section class="section" id="assembly-quality">
  <h2>Assessing assembly quality</h2>

  <p>
    When evaluating genome assemblies, we often begin with a set of standard
    statistics that summarize contiguity, size, and scaffold distribution.
    These metrics were widely used and benchmarked during the
    <strong>Assemblathon</strong> competitions, which highlighted both the
    usefulness and limitations of these summary measures.
  </p>

  <h3>Common assembly quality statistics</h3>

  <table>
    <thead>
      <tr>
        <th>Statistic</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Total assembly size</strong></td>
        <td>The total number of bases across all contigs or scaffolds.</td>
      </tr>
      <tr>
        <td><strong>Number of contigs / scaffolds</strong></td>
        <td>Counts of discrete assembled sequences; fewer typically indicates a more contiguous assembly.</td>
      </tr>
      <tr>
        <td><strong>N50</strong></td>
        <td>
          The contig or scaffold length at which 50% of the assembly is
          contained in sequences of this length or longer.
        </td>
      </tr>
      <tr>
        <td><strong>L50</strong></td>
        <td>
          The number of contigs or scaffolds whose combined length reaches 50%
          of the total assembly; lower values indicate higher contiguity.
        </td>
      </tr>
      <tr>
        <td><strong>NG50</strong></td>
        <td>
          Similar to N50 but based on an expected genome size rather than the
          assembled size.
        </td>
      </tr>
      <tr>
        <td><strong>Largest contig / scaffold</strong></td>
        <td>The length of the longest assembled sequence.</td>
      </tr>
      <tr>
        <td><strong>N90, L90</strong></td>
        <td>
          Like N50 and L50, but for 90% of the genome; emphasizes fragmentation
          in smaller contigs.
        </td>
      </tr>
    </tbody>
  </table>

  <p>
    These metrics give a high-level sense of contiguity and fragmentation, but
    they do not directly measure biological correctness or completeness. This
    was a key lesson from the Assemblathon competitions.
  </p>

  <h3>The Assemblathon perspective</h3>

  <p>
    The <strong>Assemblathon</strong> genome assembly competitions brought
    together dozens of assembly methods and highlighted an important insight:
    <strong>no single statistic captures overall assembly quality</strong>.
  </p>

  <p>
    Assemblathon organizers demonstrated that assemblies with similar N50
    values could differ substantially in correctness, structural accuracy,
    repeat resolution, and completeness. Conversely, assemblies with lower
    N50 values were sometimes more accurate or biologically faithful.
  </p>

  <div class="card" style="background:#f9fafb; border:1px solid #e5e7eb; margin-top:1rem;">
    <h3 style="margin-top:0;">Assemblathon key takeaways</h3>
    <ul>
      <li>N50 alone is not sufficient to judge assembly quality.</li>
      <li>Contiguity and correctness are not always correlated.</li>
      <li>Different assemblers have different strengths (repeat resolution, accuracy, haplotype handling).</li>
      <li>Multiple metrics must be combined for a reliable assessment.</li>
    </ul>
  </div>

  <figure>
    <img src="img/assemblathon-summary.png" alt="Assemblathon summary figure placeholder">
    <figcaption>
      Summary of considerations from the Assemblathon genome assembly challenge (placeholder).
    </figcaption>
  </figure>

</section>


      <!-- COMPLEASM -->
      <section class="section" id="compleasm">
        <h2>Assembly completeness with compleasm</h2>

        <p>
          Compleasm evaluates completeness using BUSCO lineage datasets.
          For birds, use <code>aves_odb10</code> or <code>aves_odb12</code>.
        </p>

<div class="code-block-green">
compleasm run \
  -a hornbill_assembly.fasta \
  -o compleasm-output \
  -l aves_odb10 \
  -t 8
</div>

        <figure>
          <img src="img/compleasm-summary.png" alt="Completeness summary plot." />
          <figcaption>Example completeness summary (placeholder).</figcaption>
        </figure>

      </section>

      <!-- HI-C -->
      <section class="section" id="hic">
        <h2>Interpreting Hi-C data</h2>

        <p>
          Hi-C contact maps reveal long-range interactions along chromosomes and are used to scaffold contigs into chromosome-scale assemblies.
        </p>

        <figure>
          <img src="img/hic-contact-map.png" alt="Hi-C contact map." />
          <figcaption>Example Hi-C contact map (placeholder).</figcaption>
        </figure>

        <p>
          A strong diagonal indicates well-assembled chromosomes. Off-diagonal blocks may indicate misjoins or rearrangements.
        </p>
      </section>

      <!-- FURTHER ANALYSES -->
      <section class="section" id="further">
        <h2>Further analyses</h2>

        <ul>
          <li>Genome annotation</li>
          <li>Variant calling</li>
          <li>Comparative genomics & synteny</li>
          <li>Demographic inference</li>
          <li>Conservation applications (ROH, mutational load, SVs)</li>
        </ul>

        <p>
          With a complete, accurate assembly, all downstream analyses become more powerful and interpretable.
        </p>
      </section>

    </section>
  </div>
</main>

</body>
</html>
